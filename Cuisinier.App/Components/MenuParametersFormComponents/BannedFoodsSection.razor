@using MudBlazor
@using Cuisinier.Core.DTOs

<MudDivider Class="my-4" />
<MudText Typo="Typo.h6" Class="mb-3">Aliments à bannir</MudText>
<MudText Typo="Typo.body2" Class="mb-3">Liste des aliments à exclure des recettes</MudText>

@if (BannedFoods.Any())
{
    <div class="mb-3">
        @foreach (var (index, aliment) in BannedFoods.Select((a, idx) => (idx, a)).ToList())
        {
            <MudChip T="string" 
                    OnClose="@(() => OnRemove.InvokeAsync(index))"
                    Color="Color.Error"
                    Variant="Variant.Filled"
                    Class="ma-1">
                @aliment
            </MudChip>
        }
    </div>
}

<MudGrid Class="mt-2">
    <MudItem xs="12" sm="10">
        <MudTextField Value="@NewFood" 
                     ValueChanged="@((string value) => NewFoodChanged.InvokeAsync(value))"
                     Label="Ajouter un aliment à bannir"
                     Variant="Variant.Outlined"
                     OnKeyDown="@((KeyboardEventArgs e) => { if (e.Key == "Enter" || e.Key == "NumpadEnter") OnAdd.InvokeAsync(); })" />
    </MudItem>
    <MudItem xs="12" sm="2" Class="d-flex align-center">
        <MudButton Variant="Variant.Filled" 
                  Color="Color.Error"
                  OnClick="OnAdd"
                  FullWidth="true"
                  Class="mt-2 mt-sm-0">
            Ajouter
        </MudButton>
    </MudItem>
</MudGrid>

@code {
    [Parameter] public List<string> BannedFoods { get; set; } = new();
    [Parameter] public string NewFood { get; set; } = "";
    [Parameter] public EventCallback<string> NewFoodChanged { get; set; }
    [Parameter] public EventCallback<int> OnRemove { get; set; }
    [Parameter] public EventCallback OnAdd { get; set; }
}

