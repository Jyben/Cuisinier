@using MudBlazor

<MudText Typo="Typo.h6" Class="mb-2">Nombre de plats</MudText>
<MudText Typo="Typo.body2" Class="mb-4 helper-text-secondary">DÃ©finissez combien de plats vous souhaitez pour chaque nombre de personnes</MudText>

<div class="nombre-plats-container">
    @for (int i = 0; i < NumberOfDishesValues.Count; i++)
    {
        var index = i;
        <MudPaper Elevation="1" Class="nombre-plat-card">
            <MudStack Spacing="3" Class="pa-3">
                @if (NumberOfDishesValues.Count > 1)
                {
                    <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.FlexEnd">
                        <MudIconButton Icon="@Icons.Material.Filled.Delete" 
                                      Color="Color.Error" 
                                      Size="Size.Small"
                                      Variant="Variant.Text"
                                      OnClick="@(() => OnRemove.InvokeAsync(index))"
                                      Class="delete-plat-button" />
                    </MudStack>
                }
                
                <MudNumericField T="int" 
                               Value="@NumberOfDishesValues[index]"
                               ValueChanged="@((int value) => {
                                   NumberOfDishesValues[index] = value;
                                   OnChange.InvokeAsync();
                               })"
                               Label="Nombre de plats"
                               Min="1"
                               Max="20"
                               Variant="Variant.Outlined"
                               FullWidth="true" />
                
                <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.Center">
                    <MudText Typo="Typo.body2" Class="helper-text-secondary">pour</MudText>
                </MudStack>
                
                <MudNumericField T="int" 
                               Value="@ServingsValues[index]"
                               ValueChanged="@((int value) => {
                                   ServingsValues[index] = value;
                                   OnChange.InvokeAsync();
                               })"
                               Label="Personnes"
                               Min="1"
                               Max="20"
                               Variant="Variant.Outlined"
                               FullWidth="true" />
            </MudStack>
        </MudPaper>
    }
</div>

<MudButton Variant="Variant.Text" 
          StartIcon="@Icons.Material.Filled.Add" 
          OnClick="OnAdd"
          FullWidth="true"
          Class="mb-4 mt-3">
    Ajouter une configuration
</MudButton>

@code {
    [Parameter] public List<int> NumberOfDishesValues { get; set; } = new();
    [Parameter] public List<int> ServingsValues { get; set; } = new();
    [Parameter] public EventCallback<int> OnRemove { get; set; }
    [Parameter] public EventCallback OnAdd { get; set; }
    [Parameter] public EventCallback OnChange { get; set; }
}

